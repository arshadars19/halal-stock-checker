<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Halal Stock Checker</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        body {
            font-family: "Segoe UI", sans-serif;
            background-color: #f8fafc;
            text-align: center;
            padding: 40px;
            color: #1e293b;
        }

        h1 {
            color: #0f766e;
        }

        input {
            padding: 10px 15px;
            width: 300px;
            border-radius: 8px;
            border: 1px solid #cbd5e1;
            font-size: 16px;
        }

        button {
            padding: 10px 20px;
            background-color: #0f766e;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            margin-left: 8px;
        }

        button:hover {
            background-color: #115e59;
        }

        #result {
            margin-top: 20px;
            font-size: 20px;
            font-weight: bold;
        }

        .autocomplete-items {
            border: 1px solid #d4d4d4;
            border-bottom: none;
            border-top: none;
            max-height: 150px;
            overflow-y: auto;
            position: absolute;
            background-color: #fff;
            z-index: 99;
            width: 300px;
            left: 50%;
            transform: translateX(-50%);
        }

        .autocomplete-items div {
            padding: 10px;
            cursor: pointer;
        }

        .autocomplete-items div:hover {
            background-color: #e9e9e9;
        }
    </style>
</head>
<style>
    body {
        background-image: url('finance_investment_bg.png');
        background-size: cover;
        background-repeat: no-repeat;
        background-position: center center;
        background-attachment: fixed;
        background-color: #004d40;
    }
</style>

<body>
    <div style="display:flex; flex-direction:column; align-items:center; justify-content:center; min-height:60vh;">
        <div
            style="background:rgba(255,255,255,0.9); border-radius:16px; padding:20px; box-shadow:0 4px 24px rgba(0,0,0,0.15); margin-bottom:20px;">
            <img src="New Logo.png" alt="Halal Finance Simplified Logo" style="width:120px;">
        </div>
        <div
            style="background:rgba(255,255,255,0.92); border-radius:18px; padding:24px 32px; box-shadow:0 4px 24px rgba(0,0,0,0.15); margin-bottom:24px; text-align:center;">
            <h1 style="color:#1a3a32; margin-bottom:16px;">Halal Stock Checker</h1>
            <h3 style="color:#1a3a32; margin-top:0;">
                A product of
                <a href="https://www.instagram.com/halalfinancesimplified/" target="_blank"
                    style="color:#1a3a32; text-decoration:underline;">Halal Finance Simplified</a>
            </h3>
        </div>
    </div>

    <div
        style="display:inline-block; background:rgba(255,255,255,0.85); border-radius:12px; padding:16px 24px; box-shadow:0 2px 12px rgba(0,0,0,0.12); margin-top:16px;">
        <p>Type any company name or ticker below:</p>
    </div>
    <div style="position: relative;">
        <input type="text" id="searchInput" placeholder="e.g. ABB, Aarti Drugs" />
        <div id="autocomplete-list" class="autocomplete-items"></div>
    </div>
    <button onclick="checkStock()">Check</button>
    <div id="result"></div>

    <script>
        let halalList = [];

        // Load Excel file
        fetch('halal_list.csv')
            .then(response => response.arrayBuffer())
            .then(data => {
                const workbook = XLSX.read(data, { type: 'array' });
                const sheetName = workbook.SheetNames[0];
                const sheet = workbook.Sheets[sheetName];
                const json = XLSX.utils.sheet_to_json(sheet);
                halalList = json.map(row => ({
                    name: row["Company Name"].toString(),
                    ticker: row["Ticker"].toString()
                }));
                console.log("✅ Loaded", halalList.length, "stocks from Excel");
            })
            .catch(err => console.error("Error loading Excel file:", err));

        const searchInput = document.getElementById('searchInput');
        const autocompleteList = document.getElementById('autocomplete-list');

        searchInput.addEventListener('input', function () {
            const val = this.value.toLowerCase();
            autocompleteList.innerHTML = '';

            if (!val) return;

            const matches = halalList.filter(
                s => s.name.toLowerCase().includes(val) || s.ticker.toLowerCase().includes(val)
            ).slice(0, 10); // Limit suggestions to 10

            matches.forEach(match => {
                const item = document.createElement('div');
                item.innerHTML = `<strong>${match.name}</strong> (${match.ticker})`;
                item.addEventListener('click', function () {
                    searchInput.value = match.name;
                    autocompleteList.innerHTML = '';
                });
                autocompleteList.appendChild(item);
            });
        });

        document.addEventListener('click', function (e) {
            if (e.target !== searchInput) autocompleteList.innerHTML = '';
        });

        function checkStock() {
            const query = searchInput.value.trim().toLowerCase();
            const resultDiv = document.getElementById('result');

            if (!query) {
                resultDiv.innerHTML = '⚠️ Please enter a company name or ticker.';
                resultDiv.style.color = '#ca8a04';
                return;
            }

            const found = halalList.some(
                s => s.name.toLowerCase() === query || s.ticker.toLowerCase() === query
            );

            if (found) {
                resultDiv.innerHTML = '✅ This stock is <b>HALAL</b>';
                resultDiv.style.color = 'green';
                resultDiv.style.backgroundColor = 'white';
            } else {
                resultDiv.innerHTML = '❌ This stock Not Found in the list <b>NOT HALAL</b>';
                resultDiv.style.color = 'red';
                resultDiv.style.backgroundColor = 'white';
            }
        }
    </script>
    <div
        style="display:inline-block; background:rgba(255,255,255,0.85); border-radius:12px; padding:16px 24px; box-shadow:0 2px 12px rgba(0,0,0,0.12); margin-top:16px;">
        <p style="color:#1a3a32; margin-bottom:8px;">
            The above data is fetched from
            <a href="https://zamzam-capital.com/halal-stocks/" target="_blank" style="color:#1a3a32;">Zamzam Capital</a> website.
            If you want to know how they purify it, please visit their website for more details.
        </p>
        <p style="color:#1a3a32;">
            The list was last updated on April 26, 2025.
        </p>
    </div>
        <div
        style="display:inline-block; background:rgba(255,255,255,0.85); border-radius:12px; padding:16px 24px; box-shadow:0 2px 12px rgba(0,0,0,0.12); margin-top:16px;">
<p style="color: #000000; margin-top: 30px; font-size: 14px; text-align: center;">
  Developed with ❤️ by
  <a href="https://www.instagram.com/halalfinancesimplified/" target="_blank"
     style="color: #000000; text-decoration: none; font-weight: bold;">Halal Finance Simplified</a>
</p>
    </div>

</body>

</html>